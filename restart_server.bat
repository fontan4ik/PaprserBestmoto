@echo off
echo ============================================================
echo Остановка старого сервера и очистка порта 5000
echo ============================================================

REM Останавливаем все процессы Python
taskkill /F /IM python.exe /T 2>nul
timeout /t 2 /nobreak >nul

REM Проверяем, что порт свободен
netstat -ano | findstr ":5000" | findstr "LISTENING"
if %errorlevel% == 0 (
    echo Порт 5000 все еще занят. Попробуйте перезагрузить компьютер.
    pause
    exit /b 1
)

echo ============================================================
echo Порт 5000 свободен. Запуск сервера...
echo ============================================================

REM Активируем виртуальное окружение и запускаем сервер
call .venv\Scripts\activate.bat
python server.py

pause

